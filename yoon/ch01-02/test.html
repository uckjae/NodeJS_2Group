<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        function ex02() {
            var num1 = 1;
            var num2 = 2;
            var result = 3;
            var str = num1 + "더하기 " + num2 + "는 \'" + result + "\'";
            console.log(str);
            var str2 = `${num1}더하기 ${num2}는 '${result}'`;
            console.log(str2);
        }

        function ex03() {
            var sayNode = function () {
                console.log('node');
            };

            var es = 'ES';

            var oldObject = {
                sayJS: function () {
                    console.log('JS');
                },
                sayNode: sayNode
            };

            oldObject[es + 6] = 'Fantastic';
            oldObject.sayNode(); //node
            oldObject.sayJS(); //JS
            console.log(oldObject.ES6); //Fantastic

            const newObject = {
                sayJS() {
                    console.log('JS');
                },
                sayNode,
                [es + 6]: 'Fantastic'
            };

            newObject.sayNode(); //node
            newObject.sayJS(); //JS
            console.log(newObject.ES6); //Fantastic
        }

        function ex04() {
            function add(x, y) {
                return x + y;
            }

            const add2 = (x, y) => {
                return x + y;
            };

            const add3 = (x, y) => (x + y);
            const add4 = (x, y) => x + y;

            function not(x) {
                return !x;
            }

            const not1 = x => !x;
        }

        function ex04_2() {
            var relationship1 = {
                name: 'zero',
                friends: ['nero', 'hero', 'xero'],
                logFriends: function () {
                    var that = this; //relationship1
                    this.friends.forEach(function (friend) {
                        console.log(that.name, friend); // 해당 함수 안의 this와 상위단의 this가 다르다.
                    });
                }
            };

            relationship1.logFriends();

            var relationship2 = {
                name: 'zero',
                friends: ['nero', 'hero', 'xero'],
                logFriends: function () {
                    this.friends.forEach(friend => {
                        console.log(this.name, friend); // 상위 scope을 그대로 물려받음
                    })
                }
            };
            relationship2.logFriends();
        }

        // 비구조 할당
        function ex05() {
            var candyMachine = {
                status: {
                    name: 'node',
                    count: 5
                },
                getCandy: function () {
                    this.status.count--;
                    return this.status.count;
                }
            };

            var getCandy = candyMachine.getCandy(); //4
            var count = candyMachine.status.count; //4
            console.log(`getCandy : ${getCandy}\ncount : ${count}`);
        }

        function ex05_2() {
            const candyMachine = {
                status: {
                    name: 'node',
                    count: 5
                },
                getCandy: function () {
                    this.status.count--;
                    return this.status.count;
                }
            };

            // 자기 자신의 값을 자신에게 할당
            const {
                getCandy,
                status: {
                    count
                }
            } = candyMachine;

            var getCandy1 = candyMachine.getCandy();
            var count1 = candyMachine.status.count;
            console.log(`getCandy : ${getCandy1}\ncount : ${count1}`);
        }

        function ex05_3() {
            var array = ['nodejs', {}, 10, true];
            var node = array[0];
            var obj = array[1];
            var bool = array[2];

            const array2 = ['nodejs', {}, 10, true];
            const [node1, obj1, , bool1] = array2; // 배열 순서 대로 할당됨
            console.log(node1);
            console.log(obj1);
            console.log(bool1);
        }

        function ex06() {
            //1. 프로미스 객체 생성
            const condition = true; //treu(resolve),false(reject)
            const promise = new Promise((resolve, reject) => {
                if (condition) {
                    resolve('성공');
                } else {
                    reject('실패');
                }
            });

            promise
                .then(message => console.log(message)) //resolve
                .catch(error => console.error(error)); //reject

            console.log("------------------------------");
            promise
                .then(message => {
                    return new Promise((resolve, reject) => {
                        console.log(message + "-1");
                        resolve(message + "-1")
                    });
                })
                .then(message => {
                    {
                        console.log(message + "-2");
                        return new Promise((resolve, reject) => {
                            resolve(message)
                        });
                    }
                })
                .then(message => {
                    console.log(message + "-3");
                    return new Promise((resolve, reject) => {
                        resolve(message)
                    });
                })
                .catch(error => console.error(error));
        }

        function findAndSaveUser(Users) {
            Users.findOne({}, (err, user) => { // 첫번째 콜백
                if (err) {
                    return console.error(err);
                }
                user.name = 'zero';
                user.save(err => { //두번째 콜백
                    if (err) {
                        return console.error(err);
                    }
                    Users.findOne({
                        gerder: 'm'
                    }, (err, user) => { // 세번째 콜백
                        if (err) {
                            return console.error(err);
                        }
                    });
                });
            });
        }

        async function findAndSaveUser(Users) {
            try {
                let user = await Users.findOne({});
                user.name = 'zero';
                user = await user.save();
                user = await User.findOne({
                    gender: 'm'
                });
                // do something...
            } catch (error) {
                console.error(error);
            }
        }

        function ex_dataAttribute() {
            var data = document.querySelector('li').dataset;
            console.log(data); //DOMStringMap {id: "1", userJob: "programmer"}
        }

        $(function () {
            //ex02();
            //ex03();
            //ex04_2();
            //ex05();
            //ex05_2();
            //ex05_3();
            //ex06();
            ex_dataAttribute();
        });
    </script>
</head>

<body>
    <ul>
        <li data-id="1" , data-user-job="programmer">Zero</li>
        <li data-id="2" , data-user-job="designer">Nero</li>
        <li data-id="3" , data-user-job="programmer">Hero</li>
        <li data-id="4" , data-user-job="ceo">Kero</li>
    </ul>
</body>

</html>